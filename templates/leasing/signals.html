{% extends "base.html" %}

{% block title %}Leasing Signals - Property Management{% endblock %}
{% block page_title %}Leasing Signals{% endblock %}

{% block extra_css %}
<style>
    .signals-header {
        background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
        color: white;
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 25px;
    }
    
    .signals-header h2 {
        font-size: 24px;
        margin-bottom: 10px;
    }
    
    .signals-header p {
        opacity: 0.9;
        font-size: 14px;
    }
    
    .signal-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 25px;
    }
    
    .signal-card {
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 20px;
        position: relative;
        transition: all 0.3s ease;
    }
    
    .signal-card:hover {
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transform: translateY(-2px);
    }
    
    .signal-indicator {
        position: absolute;
        top: 15px;
        right: 15px;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        animation: pulse 2s infinite;
    }
    
    .signal-high {
        background: #ef4444;
    }
    
    .signal-medium {
        background: #f59e0b;
    }
    
    .signal-low {
        background: #10b981;
    }
    
    @keyframes pulse {
        0% {
            box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
        }
        70% {
            box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
        }
        100% {
            box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
        }
    }
    
    .signal-title {
        font-size: 16px;
        font-weight: 600;
        color: #212529;
        margin-bottom: 8px;
    }
    
    .signal-property {
        font-size: 13px;
        color: #6c757d;
        margin-bottom: 15px;
    }
    
    .signal-metrics {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-bottom: 15px;
    }
    
    .metric-item {
        padding: 8px;
        background: #f8f9fa;
        border-radius: 4px;
    }
    
    .metric-label {
        font-size: 11px;
        color: #6c757d;
        text-transform: uppercase;
        margin-bottom: 3px;
    }
    
    .metric-value {
        font-size: 18px;
        font-weight: 600;
        color: #212529;
    }
    
    .signal-actions {
        display: flex;
        gap: 10px;
    }
    
    .btn-signal {
        flex: 1;
        padding: 8px;
        border: 1px solid #dee2e6;
        background: white;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        text-align: center;
        transition: all 0.2s;
    }
    
    .btn-signal:hover {
        background: #f8f9fa;
    }
    
    .btn-signal-primary {
        background: #0d6efd;
        color: white;
        border-color: #0d6efd;
    }
    
    .btn-signal-primary:hover {
        background: #0b5ed7;
    }
    
    .filter-section {
        background: white;
        padding: 15px;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        margin-bottom: 20px;
    }
    
    .filter-row {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .filter-row select {
        padding: 6px 10px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 13px;
    }
    
    .insights-panel {
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 20px;
        margin-bottom: 20px;
    }
    
    .insights-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        color: #212529;
    }
    
    .insight-item {
        display: flex;
        align-items: center;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 4px;
        margin-bottom: 10px;
    }
    
    .insight-icon {
        width: 40px;
        height: 40px;
        background: white;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 15px;
        font-size: 20px;
    }
    
    .insight-content {
        flex: 1;
    }
    
    .insight-text {
        font-size: 14px;
        color: #212529;
        margin-bottom: 3px;
    }
    
    .insight-subtext {
        font-size: 12px;
        color: #6c757d;
    }
    
    .insight-action {
        color: #0d6efd;
        font-size: 12px;
        text-decoration: none;
    }
    
    .insight-action:hover {
        text-decoration: underline;
    }
    
    .performance-chart {
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 20px;
    }
    
    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .chart-title {
        font-size: 16px;
        font-weight: 600;
        color: #212529;
    }
    
    .chart-legend {
        display: flex;
        gap: 20px;
        font-size: 12px;
    }
    
    .legend-item {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .legend-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }
    
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #6c757d;
    }
    
    .empty-state i {
        font-size: 48px;
        margin-bottom: 20px;
        color: #dee2e6;
    }
    
    .badge-new {
        background: #10b981;
        color: white;
        padding: 2px 6px;
        border-radius: 3px;
        font-size: 10px;
        font-weight: 600;
        text-transform: uppercase;
        margin-left: 8px;
    }
</style>
{% endblock %}

{% block tabs %}
<a href="{{ url_for('vacancies') }}" class="tab-nav-item">Vacancies</a>
<a href="{{ url_for('guest_cards') }}" class="tab-nav-item">Guest Cards</a>
<a href="{{ url_for('rental_applications') }}" class="tab-nav-item">Rental Applications</a>
<a href="{{ url_for('leases') }}" class="tab-nav-item">Leases</a>
<a href="{{ url_for('renewals') }}" class="tab-nav-item">Renewals</a>
<a href="{{ url_for('leasing_metrics') }}" class="tab-nav-item">Metrics</a>
<a href="{{ url_for('signals') }}" class="tab-nav-item active">Signals</a>
{% endblock %}

{% block content %}
<div class="signals-header">
    <h2>Leasing Signals Intelligence <span class="badge-new">BETA</span></h2>
    <p>AI-powered insights to optimize your leasing performance and maximize revenue</p>
</div>

<div class="insights-panel">
    <div class="insights-title">üìä Today's Key Insights</div>
    <div class="insight-item">
        <div class="insight-icon">‚ö°</div>
        <div class="insight-content">
            <div class="insight-text"><strong>3 units</strong> are priced 15% below market rate</div>
            <div class="insight-subtext">Potential monthly revenue increase: $1,245</div>
        </div>
        <a href="#" class="insight-action">Review Pricing ‚Üí</a>
    </div>
    <div class="insight-item">
        <div class="insight-icon">üìà</div>
        <div class="insight-content">
            <div class="insight-text"><strong>Peak demand detected</strong> for 2-bedroom units</div>
            <div class="insight-subtext">27 inquiries in the last 48 hours</div>
        </div>
        <a href="#" class="insight-action">Adjust Strategy ‚Üí</a>
    </div>
    <div class="insight-item">
        <div class="insight-icon">‚è∞</div>
        <div class="insight-content">
            <div class="insight-text"><strong>5 leases</strong> expiring without renewal response</div>
            <div class="insight-subtext">Send renewal offers to avoid vacancy</div>
        </div>
        <a href="#" class="insight-action">Send Renewals ‚Üí</a>
    </div>
</div>

<div class="filter-section">
    <div class="filter-row">
        <select>
            <option>All Properties</option>
            <option>Rock Ridge Ranch</option>
            <option>Brentwood Park</option>
            <option>Lodge Apartments</option>
        </select>
        <select>
            <option>All Signal Types</option>
            <option>Pricing Alerts</option>
            <option>Demand Signals</option>
            <option>Competition Alerts</option>
            <option>Renewal Risks</option>
        </select>
        <select>
            <option>Priority: All</option>
            <option>High Priority</option>
            <option>Medium Priority</option>
            <option>Low Priority</option>
        </select>
        <button class="btn-signal btn-signal-primary">Apply Filters</button>
    </div>
</div>

<div class="signal-cards">
    <div class="signal-card">
        <div class="signal-indicator signal-high"></div>
        <div class="signal-title">‚ö†Ô∏è Pricing Below Market</div>
        <div class="signal-property">Gene Field Apts - Unit 10-02</div>
        <div class="signal-metrics">
            <div class="metric-item">
                <div class="metric-label">Current Rate</div>
                <div class="metric-value">$546</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Market Rate</div>
                <div class="metric-value">$675</div>
            </div>
        </div>
        <div class="signal-actions">
            <button class="btn-signal btn-signal-primary">Adjust Price</button>
            <button class="btn-signal">View Analysis</button>
        </div>
    </div>
    
    <div class="signal-card">
        <div class="signal-indicator signal-medium"></div>
        <div class="signal-title">üìä High Demand Detected</div>
        <div class="signal-property">Brentwood Park - 2BR Units</div>
        <div class="signal-metrics">
            <div class="metric-item">
                <div class="metric-label">Inquiries</div>
                <div class="metric-value">18</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Last 7 Days</div>
                <div class="metric-value">+45%</div>
            </div>
        </div>
        <div class="signal-actions">
            <button class="btn-signal btn-signal-primary">Optimize Listing</button>
            <button class="btn-signal">View Leads</button>
        </div>
    </div>
    
    <div class="signal-card">
        <div class="signal-indicator signal-high"></div>
        <div class="signal-title">üîÑ Renewal at Risk</div>
        <div class="signal-property">Lodge Apartments - Unit 102</div>
        <div class="signal-metrics">
            <div class="metric-item">
                <div class="metric-label">Days Until Expiry</div>
                <div class="metric-value">21</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Response</div>
                <div class="metric-value">None</div>
            </div>
        </div>
        <div class="signal-actions">
            <button class="btn-signal btn-signal-primary">Send Offer</button>
            <button class="btn-signal">Contact Tenant</button>
        </div>
    </div>
    
    <div class="signal-card">
        <div class="signal-indicator signal-low"></div>
        <div class="signal-title">üéØ Competitor Price Drop</div>
        <div class="signal-property">Market Area: Downtown</div>
        <div class="signal-metrics">
            <div class="metric-item">
                <div class="metric-label">Avg Competitor</div>
                <div class="metric-value">$1,150</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Your Avg</div>
                <div class="metric-value">$1,175</div>
            </div>
        </div>
        <div class="signal-actions">
            <button class="btn-signal">Review Comps</button>
            <button class="btn-signal">Ignore</button>
        </div>
    </div>
    
    <div class="signal-card">
        <div class="signal-indicator signal-medium"></div>
        <div class="signal-title">üì∏ Listing Quality Alert</div>
        <div class="signal-property">Walnut Ridge - Unit 6122D</div>
        <div class="signal-metrics">
            <div class="metric-item">
                <div class="metric-label">Photo Count</div>
                <div class="metric-value">2</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Avg Views</div>
                <div class="metric-value">12</div>
            </div>
        </div>
        <div class="signal-actions">
            <button class="btn-signal btn-signal-primary">Update Photos</button>
            <button class="btn-signal">Schedule Tour</button>
        </div>
    </div>
    
    <div class="signal-card">
        <div class="signal-indicator signal-low"></div>
        <div class="signal-title">‚úÖ Optimal Performance</div>
        <div class="signal-property">Summit Apartments</div>
        <div class="signal-metrics">
            <div class="metric-item">
                <div class="metric-label">Occupancy</div>
                <div class="metric-value">98%</div>
            </div>
            <div class="metric-item">
                <div class="metric-label">Avg Days</div>
                <div class="metric-value">8</div>
            </div>
        </div>
        <div class="signal-actions">
            <button class="btn-signal">View Report</button>
            <button class="btn-signal">Share Success</button>
        </div>
    </div>
</div>

<div class="performance-chart">
    <div class="chart-header">
        <div class="chart-title">Signal Response Performance</div>
        <div class="chart-legend">
            <div class="legend-item">
                <div class="legend-dot" style="background: #0d6efd;"></div>
                <span>Actions Taken</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: #28a745;"></div>
                <span>Positive Outcome</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: #6c757d;"></div>
                <span>Pending</span>
            </div>
        </div>
    </div>
    <canvas id="performanceChart" height="80"></canvas>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Performance chart
    const ctx = document.getElementById('performanceChart').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Pricing', 'Demand', 'Renewals', 'Competition', 'Quality', 'Other'],
            datasets: [{
                label: 'Actions Taken',
                data: [45, 38, 52, 28, 31, 22],
                backgroundColor: '#0d6efd'
            }, {
                label: 'Positive Outcome',
                data: [38, 32, 47, 22, 28, 19],
                backgroundColor: '#28a745'
            }, {
                label: 'Pending',
                data: [7, 6, 5, 6, 3, 3],
                backgroundColor: '#6c757d'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                x: {
                    stacked: true
                },
                y: {
                    stacked: true,
                    beginAtZero: true
                }
            }
        }
    });
});
</script>
{% endblock %}
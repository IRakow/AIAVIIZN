<!-- templates/base.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Property Management System{% endblock %}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f5f5;
            font-size: 13px;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 170px;
            background-color: #f8f9fa;
            border-right: 1px solid #dee2e6;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .sidebar-item {
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background-color 0.2s;
            border-bottom: 1px solid #e9ecef;
            text-decoration: none;
            color: #333;
            font-size: 13px;
        }

        .sidebar-item:hover {
            background-color: #e9ecef;
        }

        .sidebar-item.active {
            background-color: #d1e7fd;
            color: #0056b3;
        }

        .sidebar-item i {
            margin-right: 8px;
            font-size: 14px;
        }

        .sidebar-submenu .sidebar-item {
            padding-left: 30px;
            font-size: 12px;
        }

        .sidebar-section {
            background-color: #e9ecef;
            padding: 8px 15px;
            font-weight: 600;
            border-bottom: 2px solid #dee2e6;
            font-size: 12px;
            color: #495057;
        }

        .expand-icon {
            margin-left: auto;
            font-size: 10px;
            color: #6c757d;
        }

        .notification-badge {
            background: #dc3545;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: auto;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background-color: white;
            padding: 0;
            border-bottom: 1px solid #dee2e6;
        }

        /* Tab Navigation */
        .tab-nav {
            background-color: white;
            border-bottom: 1px solid #dee2e6;
            padding: 0 20px;
            display: flex;
            gap: 0;
        }

        .tab-nav-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
            color: #495057;
            text-decoration: none;
            font-size: 13px;
        }

        .tab-nav-item:hover {
            color: #0056b3;
            background-color: #f8f9fa;
        }

        .tab-nav-item.active {
            color: #0056b3;
            border-bottom-color: #0056b3;
            background-color: #e7f3ff;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #fafafa;
        }

        .page-title {
            font-size: 24px;
            font-weight: 400;
            margin-bottom: 20px;
            color: #333;
        }

        /* Search Box */
        .search-box {
            background-color: white;
            border: 1px solid #007bff;
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 20px;
            text-align: center;
            cursor: pointer;
            position: relative;
        }

        .search-box:hover {
            background-color: #f8f9fa;
        }

        .search-box::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid white;
        }

        /* Data Tables */
        .data-table {
            background-color: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background-color: #f8f9fa;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #dee2e6;
            color: #495057;
            font-size: 12px;
            cursor: pointer;
            user-select: none;
        }

        th:hover {
            background-color: #e9ecef;
        }

        td {
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
            font-size: 12px;
            vertical-align: top;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        /* Common Buttons */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            text-decoration: none;
            display: inline-block;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        /* Tasks Panel */
        .tasks-panel {
            width: 300px;
            background-color: white;
            border-left: 1px solid #dee2e6;
            display: flex;
            flex-direction: column;
        }

        .tasks-header {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f8f9fa;
        }

        .tasks-header h3 {
            font-size: 16px;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #6c757d;
        }

        .tasks-content {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .task-item {
            padding: 10px;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 5px;
            font-size: 13px;
            color: #0056b3;
            transition: background-color 0.2s;
        }

        .task-item:hover {
            background-color: #f8f9fa;
        }

        .task-section-title {
            font-weight: 600;
            color: #333;
            margin: 15px 0 10px 0;
            padding: 5px;
            font-size: 12px;
        }

        .star-icon {
            color: #ffc107;
            margin-right: 5px;
        }

        .support-icon {
            cursor: pointer;
            font-size: 18px;
            color: #6c757d;
            margin-left: 10px;
        }

        .assistant-icon {
            cursor: pointer;
            font-size: 18px;
            color: #6c757d;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            font-size: 12px;
        }

        .pagination-buttons {
            display: flex;
            gap: 5px;
        }

        .pagination-buttons button {
            padding: 5px 10px;
            border: 1px solid #dee2e6;
            background: white;
            cursor: pointer;
            border-radius: 3px;
        }

        .pagination-buttons button:hover {
            background: #f8f9fa;
        }

        .pagination-buttons button.active {
            background: #007bff;
            color: white;
        }

        /* Alphabet Filter */
        .alphabet-filter {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .alphabet-filter a {
            padding: 5px 10px;
            border: 1px solid #dee2e6;
            text-decoration: none;
            color: #007bff;
            border-radius: 3px;
            transition: all 0.2s;
        }

        .alphabet-filter a:hover {
            background: #007bff;
            color: white;
        }

        .alphabet-filter a.active {
            background: #007bff;
            color: white;
        }

        {% block extra_css %}{% endblock %}
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <a href="{{ url_for('dashboard') }}" class="sidebar-item {% if request.endpoint == 'dashboard' %}active{% endif %}">
                <i>üìä</i> Dashboard
            </a>
            <a href="#" class="sidebar-item">
                <i>üìÖ</i> Calendar
            </a>
            
            <!-- Leasing Section -->
            <div class="sidebar-item" onclick="toggleSubmenu('leasing')">
                <i>üîë</i> Leasing
                <span class="expand-icon" id="leasing-expand">{% if 'leasing' in request.endpoint or request.endpoint in ['vacancies', 'guest_cards', 'rental_applications', 'leases', 'renewals', 'metrics'] %}‚ñ≥{% else %}‚ñΩ{% endif %}</span>
            </div>
            <div id="leasing-submenu" class="sidebar-submenu" style="display: {% if 'leasing' in request.endpoint or request.endpoint in ['vacancies', 'guest_cards', 'rental_applications', 'leases', 'renewals', 'metrics'] %}block{% else %}none{% endif %};">
                <a href="{{ url_for('vacancies') }}" class="sidebar-item {% if request.endpoint == 'vacancies' %}active{% endif %}">
                    Vacancies
                </a>
                <a href="{{ url_for('guest_cards') }}" class="sidebar-item {% if request.endpoint == 'guest_cards' %}active{% endif %}">
                    Guest Cards
                </a>
                <a href="{{ url_for('rental_applications') }}" class="sidebar-item {% if request.endpoint == 'rental_applications' %}active{% endif %}">
                    Rental Applications
                </a>
                <a href="{{ url_for('leases') }}" class="sidebar-item {% if request.endpoint == 'leases' %}active{% endif %}">
                    Leases
                </a>
                <a href="{{ url_for('renewals') }}" class="sidebar-item {% if request.endpoint == 'renewals' %}active{% endif %}">
                    Renewals
                </a>
                <a href="{{ url_for('metrics') }}" class="sidebar-item {% if request.endpoint == 'metrics' %}active{% endif %}">
                    Metrics
                </a>
                <a href="#" class="sidebar-item">
                    Signals
                </a>
            </div>
            
            <!-- Properties -->
            <a href="{{ url_for('properties') }}" class="sidebar-item {% if request.endpoint == 'properties' %}active{% endif %}">
                <i>üè¢</i> Properties
            </a>
            
            <!-- People Section -->
            <div class="sidebar-item" onclick="toggleSubmenu('people')">
                <i>üë•</i> People
                <span class="expand-icon" id="people-expand">{% if request.endpoint in ['tenants', 'owners', 'vendors'] %}‚ñ≥{% else %}‚ñΩ{% endif %}</span>
            </div>
            <div id="people-submenu" class="sidebar-submenu" style="display: {% if request.endpoint in ['tenants', 'owners', 'vendors'] %}block{% else %}none{% endif %};">
                <a href="{{ url_for('tenants') }}" class="sidebar-item {% if request.endpoint == 'tenants' %}active{% endif %}">Tenants</a>
                <a href="{{ url_for('owners') }}" class="sidebar-item {% if request.endpoint == 'owners' %}active{% endif %}">Owners</a>
                <a href="{{ url_for('vendors') }}" class="sidebar-item {% if request.endpoint == 'vendors' %}active{% endif %}">Vendors</a>
            </div>
            
            <!-- Accounting Section -->
            <div class="sidebar-item" onclick="toggleSubmenu('accounting')">
                <i>üíº</i> Accounting
                <span class="expand-icon" id="accounting-expand">{% if 'accounting' in request.endpoint or request.endpoint in ['receivables', 'payables', 'bank_accounts', 'journal_entries', 'bank_transfers', 'gl_accounts', 'diagnostics'] %}‚ñ≥{% else %}‚ñΩ{% endif %}</span>
            </div>
            <div id="accounting-submenu" class="sidebar-submenu" style="display: {% if 'accounting' in request.endpoint or request.endpoint in ['receivables', 'payables', 'bank_accounts', 'journal_entries', 'bank_transfers', 'gl_accounts', 'diagnostics'] %}block{% else %}none{% endif %};">
                <a href="{{ url_for('receivables') }}" class="sidebar-item {% if request.endpoint == 'receivables' %}active{% endif %}">Receivables</a>
                <a href="{{ url_for('payables') }}" class="sidebar-item {% if request.endpoint == 'payables' %}active{% endif %}">Payables</a>
                <a href="{{ url_for('bank_accounts') }}" class="sidebar-item {% if request.endpoint == 'bank_accounts' %}active{% endif %}">Bank Accounts</a>
                <a href="{{ url_for('journal_entries') }}" class="sidebar-item {% if request.endpoint == 'journal_entries' %}active{% endif %}">Journal Entries</a>
                <a href="{{ url_for('bank_transfers') }}" class="sidebar-item {% if request.endpoint == 'bank_transfers' %}active{% endif %}">Bank Transfers</a>
                <a href="{{ url_for('gl_accounts') }}" class="sidebar-item {% if request.endpoint == 'gl_accounts' %}active{% endif %}">GL Accounts</a>
                <a href="{{ url_for('diagnostics') }}" class="sidebar-item {% if request.endpoint == 'diagnostics' %}active{% endif %}">Diagnostics</a>
            </div>
            
            <!-- Maintenance Section -->
            <div class="sidebar-item" onclick="toggleSubmenu('maintenance')">
                <i>üîß</i> Maintenance
                <span class="expand-icon" id="maintenance-expand">{% if 'maintenance' in request.endpoint %}‚ñ≥{% else %}‚ñΩ{% endif %}</span>
            </div>
            <div id="maintenance-submenu" class="sidebar-submenu" style="display: {% if 'maintenance' in request.endpoint %}block{% else %}none{% endif %};">
                <a href="#" class="sidebar-item">Work Orders</a>
                <a href="#" class="sidebar-item">Recurring Work Orders</a>
                <a href="#" class="sidebar-item">Inspections</a>
                <a href="#" class="sidebar-item">Unit Turns</a>
                <a href="#" class="sidebar-item">Projects</a>
                <a href="#" class="sidebar-item">Purchase Orders</a>
                <a href="#" class="sidebar-item">Inventory</a>
                <a href="#" class="sidebar-item">Fixed Assets</a>
                <a href="#" class="sidebar-item">Smart Maintenance</a>
            </div>
            
            <!-- Reporting Section -->
            <div class="sidebar-item" onclick="toggleSubmenu('reporting')">
                <i>üìà</i> Reporting
                <span class="expand-icon" id="reporting-expand">‚ñΩ</span>
            </div>
            <div id="reporting-submenu" class="sidebar-submenu" style="display: none;">
                <a href="#" class="sidebar-item">Financial Reports</a>
                <a href="#" class="sidebar-item">Occupancy Reports</a>
            </div>
            
            <!-- Communication Section -->
            <div class="sidebar-item" onclick="toggleSubmenu('communication')">
                <i>üí¨</i> Communication
                <span class="expand-icon" id="communication-expand">‚ñΩ</span>
            </div>
            <div id="communication-submenu" class="sidebar-submenu" style="display: none;">
                <a href="#" class="sidebar-item">Messages</a>
                <a href="#" class="sidebar-item">Announcements</a>
            </div>
            
            <a href="#" class="sidebar-item">
                <i>‚ùì</i> What's New
                <span class="notification-badge">4</span>
            </a>
            
            <!-- Company Name at Bottom -->
            <div class="sidebar-section" style="margin-top: auto;">
                Celtic Property Management
            </div>
            <a href="#" class="sidebar-item" onclick="toggleSidebar()">
                <i>‚öôÔ∏è</i> Minimize
            </a>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header with Tabs (if needed) -->
            {% block header %}{% endblock %}

            <!-- Content Area -->
            <div class="content-area">
                {% block content %}{% endblock %}
            </div>
        </div>

        <!-- Tasks Panel (Dynamic per page) -->
        {% block tasks_panel %}{% endblock %}
    </div>

    <script>
        // Toggle submenu
        function toggleSubmenu(menu) {
            const submenu = document.getElementById(menu + '-submenu');
            const expandIcon = document.getElementById(menu + '-expand');
            
            if (submenu.style.display === 'none' || submenu.style.display === '') {
                submenu.style.display = 'block';
                expandIcon.textContent = '‚ñ≥';
            } else {
                submenu.style.display = 'none';
                expandIcon.textContent = '‚ñΩ';
            }
        }

        // Toggle sidebar
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            if (sidebar.style.width === '50px') {
                sidebar.style.width = '170px';
                document.querySelectorAll('.sidebar-item').forEach(item => {
                    item.querySelector('span')?.style.display = 'inline';
                });
            } else {
                sidebar.style.width = '50px';
                document.querySelectorAll('.sidebar-item span').forEach(span => {
                    span.style.display = 'none';
                });
            }
        }

        // Toggle tasks panel
        function toggleTasks() {
            const tasksPanel = document.getElementById('tasks-panel');
            if (tasksPanel) {
                tasksPanel.style.display = tasksPanel.style.display === 'none' ? 'flex' : 'none';
            }
        }

        {% block scripts %}{% endblock %}
    </script>
</body>
</html>
{% extends "base.html" %}

{% block title %}Journal Entries - Property Management{% endblock %}
{% block page_title %}Journal Entries{% endblock %}

{% block extra_css %}
<style>
    .filter-section {
        background-color: white;
        padding: 15px;
        margin-bottom: 20px;
        border: 1px solid #dee2e6;
        border-radius: 4px;
    }
    
    .filter-row {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .filter-row input[type="text"],
    .filter-row input[type="date"],
    .filter-row select {
        padding: 6px 10px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 13px;
    }
    
    .filter-row input[type="date"] {
        width: 140px;
    }
    
    .btn {
        padding: 6px 12px;
        border: 1px solid #dee2e6;
        background: white;
        border-radius: 4px;
        cursor: pointer;
        font-size: 13px;
    }
    
    .btn-primary {
        background-color: #0d6efd;
        color: white;
        border-color: #0d6efd;
    }
    
    .btn-success {
        background-color: #28a745;
        color: white;
        border-color: #28a745;
    }
    
    .data-table {
        background: white;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        overflow: hidden;
    }
    
    .data-table table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .data-table th {
        background-color: #f8f9fa;
        padding: 10px;
        text-align: left;
        font-weight: 600;
        font-size: 12px;
        color: #495057;
        border-bottom: 2px solid #dee2e6;
        white-space: nowrap;
    }
    
    .data-table td {
        padding: 10px;
        border-bottom: 1px solid #dee2e6;
        font-size: 13px;
    }
    
    .data-table tr:hover {
        background-color: #f8f9fa;
    }
    
    .amount-debit {
        color: #28a745;
        font-weight: 500;
    }
    
    .amount-credit {
        color: #dc3545;
        font-weight: 500;
    }
    
    .journal-ref {
        color: #0d6efd;
        text-decoration: none;
        font-weight: 500;
    }
    
    .journal-ref:hover {
        text-decoration: underline;
    }
    
    .action-buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }
    
    .stats-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }
    
    .stat-card {
        background: white;
        padding: 15px;
        border: 1px solid #dee2e6;
        border-radius: 4px;
    }
    
    .stat-label {
        font-size: 11px;
        color: #6c757d;
        text-transform: uppercase;
        margin-bottom: 5px;
    }
    
    .stat-value {
        font-size: 24px;
        font-weight: 600;
        color: #212529;
    }
    
    .pagination {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background: #f8f9fa;
        border-top: 1px solid #dee2e6;
    }
    
    .pagination-info {
        color: #6c757d;
        font-size: 13px;
    }
    
    .pagination-controls {
        display: flex;
        gap: 5px;
    }
    
    .pagination-controls button {
        padding: 5px 10px;
        border: 1px solid #dee2e6;
        background: white;
        cursor: pointer;
        font-size: 13px;
    }
    
    .pagination-controls button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    .pagination-controls button.active {
        background: #0d6efd;
        color: white;
        border-color: #0d6efd;
    }
</style>
{% endblock %}

{% block tabs %}
<a href="{{ url_for('receivables') }}" class="tab-nav-item">Receivables</a>
<a href="{{ url_for('payables') }}" class="tab-nav-item">Payables</a>
<a href="{{ url_for('bank_accounts') }}" class="tab-nav-item">Bank Accounts</a>
<a href="{{ url_for('journal_entries') }}" class="tab-nav-item active">Journal Entries</a>
<a href="{{ url_for('bank_transfers') }}" class="tab-nav-item">Bank Transfers</a>
<a href="{{ url_for('gl_accounts') }}" class="tab-nav-item">GL Accounts</a>
<a href="{{ url_for('diagnostics') }}" class="tab-nav-item">Diagnostics</a>
{% endblock %}

{% block content %}
<div class="action-buttons">
    <button class="btn btn-success">
        <i class="fas fa-plus"></i> New Journal Entry
    </button>
    <button class="btn btn-primary">
        <i class="fas fa-upload"></i> Import Entries
    </button>
    <button class="btn">
        <i class="fas fa-download"></i> Export
    </button>
</div>

<div class="stats-row">
    <div class="stat-card">
        <div class="stat-label">Total Debits (Month)</div>
        <div class="stat-value">$24,470.88</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Total Credits (Month)</div>
        <div class="stat-value">$1,216.42</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Net Activity</div>
        <div class="stat-value">$23,254.46</div>
    </div>
    <div class="stat-card">
        <div class="stat-label">Entries This Month</div>
        <div class="stat-value">7</div>
    </div>
</div>

<div class="filter-section">
    <form method="get" action="{{ url_for('journal_entries') }}">
        <div class="filter-row">
            <input type="date" name="start_date" value="{{ request.args.get('start_date', '') }}" placeholder="Start Date">
            <span>to</span>
            <input type="date" name="end_date" value="{{ request.args.get('end_date', '') }}" placeholder="End Date">
            <select name="property">
                <option value="">All Properties</option>
                <option value="homestead">Homestead Villas</option>
                <option value="indian">Indian Creek Townhomes</option>
                <option value="eaton">Eaton Apartments</option>
                <option value="randall">Randall Court Ventures</option>
            </select>
            <select name="account">
                <option value="">All Accounts</option>
                <option value="1150">1150 - Cash in Bank</option>
                <option value="1160">1160 - Escrow Cash</option>
                <option value="1503">1503 - Construction Reserve</option>
            </select>
            <input type="text" name="reference" placeholder="Reference #" style="width: 120px;">
            <button type="submit" class="btn btn-primary">Search</button>
            <button type="reset" class="btn">Clear</button>
        </div>
    </form>
</div>

<div class="data-table">
    <table>
        <thead>
            <tr>
                <th>Entry Date ↕</th>
                <th>Reference # ↕</th>
                <th>Property ↕</th>
                <th>Remarks</th>
                <th>Account</th>
                <th style="text-align: right;">Debit ↕</th>
                <th style="text-align: right;">Credit ↕</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in journal_entries %}
            <tr>
                <td>{{ entry.date }}</td>
                <td><a href="#" class="journal-ref">{{ entry.reference }}</a></td>
                <td>{{ entry.property }}</td>
                <td>{{ entry.remarks }}</td>
                <td>{{ entry.account }}</td>
                <td style="text-align: right;">
                    {% if entry.debit > 0 %}
                        <span class="amount-debit">${{ "%.2f"|format(entry.debit) }}</span>
                    {% else %}
                        --
                    {% endif %}
                </td>
                <td style="text-align: right;">
                    {% if entry.credit > 0 %}
                        <span class="amount-credit">${{ "%.2f"|format(entry.credit) }}</span>
                    {% else %}
                        --
                    {% endif %}
                </td>
                <td>
                    <a href="#" style="color: #0d6efd; margin-right: 10px;"><i class="fas fa-edit"></i></a>
                    <a href="#" style="color: #dc3545;"><i class="fas fa-trash"></i></a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="8" style="text-align: center; padding: 40px; color: #6c757d;">
                    No journal entries found for the selected criteria
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div class="pagination">
        <div class="pagination-info">
            Showing 1-7 of 7 entries
        </div>
        <div class="pagination-controls">
            <button disabled>← Previous</button>
            <button class="active">1</button>
            <button disabled>Next →</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Add any journal entry specific JavaScript here
document.addEventListener('DOMContentLoaded', function() {
    // Handle entry clicks
    document.querySelectorAll('.journal-ref').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            // Open journal entry detail modal
            console.log('Opening journal entry:', this.textContent);
        });
    });
});
</script>
{% endblock %}